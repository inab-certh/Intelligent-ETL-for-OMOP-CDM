{
    "business_logic": "For every unique combination of address fields (like city, state, zip, etc.), there should be a single, stable location_id.",
    "target_table": "omop.location",
    "source_table": "location_enriched_view",
    "distinct_group": {
      "columns": [
        {
          "target": "location_id",
          "source": ["city", "state_abbreviation", "zip"],
          "transform": "row_number"
        },
        {
          "target": "city",
          "source": "city"
        },
        {
          "target": "state",
          "source": "state_abbreviation"
        },
        {
          "target": "zip",
          "source": "zip"
        },
        {
          "target": "location_source_value",
          "source": "zip"
        }
      ]
    },
    "columns": [
      {
        "target": "address_1",
        "transform": "null",
        "cast_type": "VARCHAR"
      },
      {
        "target": "address_2",
        "transform": "null",
        "cast_type": "VARCHAR"
      },
      {
        "target": "county",
        "transform": "null",
        "cast_type": "VARCHAR"
      }
    ]
  }
  